# spikesorting_wp
## BestBasis:
- c个模式类<img src="https://latex.codecogs.com/gif.latex?\omega_1,&space;\omega_2,...,\omega_c" title="\omega_1, \omega_2,...,\omega_c" />的训练样本集<img src="https://latex.codecogs.com/gif.latex?\left\{&space;\xi^{(i,k)},i=1,2,...,c;&space;k=1,2,...,N_i&space;\right\}" title="\left\{ \xi^{(i,k)},i=1,2,...,c; k=1,2,...,N_i \right\}" />；
- <img src="https://latex.codecogs.com/gif.latex?\xi^{(i,k)}=\left(&space;\xi_1^{(i,k)},\xi_2^{(i,k)},...,\xi_m^{(i,k)}&space;\right)" title="\xi^{(i,k)}=\left( \xi_1^{(i,k)},\xi_2^{(i,k)},...,\xi_m^{(i,k)} \right)" />为<img src="https://latex.codecogs.com/gif.latex?\omega_i" title="\omega_i" />中第k个m维样本矢量，<img src="https://latex.codecogs.com/gif.latex?N_i" title="N_i" />为<img src="https://latex.codecogs.com/gif.latex?\omega_i" title="\omega_i" />类的样本数；
- 对<img src="https://latex.codecogs.com/gif.latex?\xi^{(i,k)}" title="\xi^{(i,k)}" />进行小波分解，分解级数<img src="https://latex.codecogs.com/gif.latex?j=1,2,...,L" title="j=1,2,...,L" />。
- 第j级中第n个小波包子空间为<img src="https://latex.codecogs.com/gif.latex?U_j^n&space;(j=1,2,...,L;&space;n=0,1,...,2^j-1)" title="U_j^n (j=1,2,...,L; n=0,1,...,2^j-1)" />，<img src="https://latex.codecogs.com/gif.latex?U_j^n" title="U_j^n" />中的小波包系数为{ <img src="https://latex.codecogs.com/gif.latex?x_p^{i,k},p=1,2,...,P_j" title="x_p^{(i,k)},p=1,2,...,P_j" /> }
- 计算<img src="https://latex.codecogs.com/gif.latex?U_n^j" title="U_n^j" />中第p个小波包系数<img src="https://latex.codecogs.com/gif.latex?x_p^{i,k}" title="x_p^{i,k}" />对应的<img src="https://latex.codecogs.com/gif.latex?J_{Ap}" title="J_Ap" />。<img src="https://latex.codecogs.com/gif.latex?J_{Ap}(p=1,2,...,P_j)" title="J_{Ap}(p=1,2,...,P_j)" />越大，对应的该特征分量的可分性越好；
- <img src="https://latex.codecogs.com/gif.latex?U_n^j" title="U_n^j" />中所有<img src="https://latex.codecogs.com/gif.latex?J_{Ap}(p=1,2,...,P_j)" title="J_{Ap}(p=1,2,...,P_j)" />的平均值为：（对应每个子空间<img src="https://latex.codecogs.com/gif.latex?U_n^j" title="U_n^j" />，得到一个对应的<img src="https://latex.codecogs.com/gif.latex?J_{(j,n)}" title="J_{(j,n)}" />）
  
  <img src="https://latex.codecogs.com/gif.latex?J_{(j,n))}=\frac{1}{P_j}\sum_{p=1}^{P_j}P_{Ap}" title="J_{(j,n))}=\frac{1}{P_j}\sum_{p=1}^{P_j}P_{Ap}" />
  
	在小波包库中找到使<img src="https://latex.codecogs.com/gif.latex?\sum&space;J_{(j,n)}" title="\sum J_{(j,n)}" />为最大值的小波包基（最优基），该小波包基中所有m个小波包系数对应的<img src="https://latex.codecogs.com/gif.latex?J_{Al}" title="J_{Al}" />的值为<img src="https://latex.codecogs.com/gif.latex?J_{A1},J_{A2},...,J_{Am}" title="J_{A1},J_{A2},...,J_{Am}" />。对其进行排序，得：<img src="https://latex.codecogs.com/gif.latex?J^*_{A1}\geqslant&space;J^*_{A2}\geqslant&space;,...,\geqslant&space;J^*_{Am}" title="J^*_{A1}\geqslant J^*_{A2}\geqslant ,...,\geqslant J^*_{Am}" />
## ComputeJAl:
- c个模式类<img src="https://latex.codecogs.com/gif.latex?\omega_1,&space;\omega_2,...,\omega_c" title="\omega_1, \omega_2,...,\omega_c" />，每个类别的样本数为ni的特征矢量集<img src="https://latex.codecogs.com/gif.latex?\left\{&space;x^{(i,k)},i=1,2,...,c;&space;k=1,2,...,N_i&space;\right\}" title="\left\{ \xi^{(i,k)},i=1,2,...,c; k=1,2,...,N_i \right\}" />，其中<img src="https://latex.codecogs.com/gif.latex?\xi^{(i,k)}=\left(&space;\xi_1^{(i,k)},\xi_2^{(i,k)},...,\xi_m^{(i,k)}&space;\right)" title="x^{(i,k)}=\left( x_1^{(i,k)},x_2^{(i,k)},...,x_m^{(i,k)} \right)" />为<img src="https://latex.codecogs.com/gif.latex?\omega_i" title="\omega_i" />中第k个m维特征矢量。
- <img src="https://latex.codecogs.com/gif.latex?P_i" title="P_i" />为第i类样本的先验概率；
<img src="https://latex.codecogs.com/gif.latex?S_w" title="S_w" />、<img src="https://latex.codecogs.com/gif.latex?S_b" title="S_b" />分别为类内、类间的离散度度量；
距离准则定义为：<img src="https://latex.codecogs.com/gif.latex?J=\frac{S_b}{S_w}" title="J=\frac{S_b}{S_w}" />：
<img src="https://latex.codecogs.com/gif.latex?\\M_i=\frac{1}{n_i}\sum_{k=1}^{n_i}x^{(i,k)}&space;\\M=\sum_{i=-1}^{c}P_iM_i&space;\\S_w=\sum_{i=1}^c&space;P_i&space;\frac{1}{n_i}&space;\sum_{k=1}^{n_i}(x^{(i,k)})(x^{(i,k)}-M_i)^T&space;\\S_b=\sum_{i=1}^cP_i(M_i-M)(M_i-M)^T" title="\\M_i=\frac{1}{n_i}\sum_{k=1}^{n_i}x^{(i,k)} \\M=\sum_{i=-1}^{c}P_iM_i \\S_w=\sum_{i=1}^c P_i \frac{1}{n_i} \sum_{k=1}^{n_i}(x^{(i,k)})(x^{(i,k)}-M_i)^T \\S_b=\sum_{i=1}^cP_i(M_i-M)(M_i-M)^T" />
- 当特征矢量即m=1时，有：
<img src="https://latex.codecogs.com/gif.latex?\\M_{il}=\frac{1}{n_i}\sum_{k=1}^{n_i}x_l^{(i,k)}&space;\\M_l=\sum_{i=-1}^{c}P_iM_{il}&space;\\S_{wl}=\sum_{i=1}^c&space;P_i&space;\frac{1}{n_i}&space;\sum_{k=1}^{n_i}(x_l^{(i,k)}-M_{il})^2&space;\\S_bl=\sum_{i=1}^c&space;P_i&space;(M_{il}-M_l)^2&space;\\J_{Al}=\frac{S_{bl}}{S_{wl}}" title="\\M_{il}=\frac{1}{n_i}\sum_{k=1}^{n_i}x_l^{(i,k)} \\M_l=\sum_{i=-1}^{c}P_iM_{il} \\S_{wl}=\sum_{i=1}^c P_i \frac{1}{n_i} \sum_{k=1}^{n_i}(x_l^{(i,k)}-M_{il})^2 \\S_bl=\sum_{i=1}^c P_i (M_{il}-M_l)^2 \\J_{Al}=\frac{S_{bl}}{S_{wl}}" />



